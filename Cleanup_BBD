import pandas as pd

# Load the dataset
file_path = "API_IT.NET.BBND.P2_DS2_en_csv_v2_14223\API_IT.NET.BBND.P2_DS2_en_csv_v2_14223.csv"
df = pd.read_csv(file_path, skiprows=4)

# Filter for a specific country (modify as needed)

selected_countries = ["Argentina", "Uruguay", "Chile"]  # Add more countries if needed
df_filtered = df[df["Country Name"].isin(selected_countries)]

# Drop unnecessary columns
columns_to_drop = ["Indicator Name", "Indicator Code", "Unnamed: 68"]  # Modify based on actual structure
df_filtered = df_filtered.drop(columns=columns_to_drop, errors="ignore")

# Melt the dataset to convert years into rows
df_melted = df_filtered.melt(id_vars=["Country Name", "Country Code"], 
                             var_name="Year", value_name="Fixed Broadband Subscriptions (per 100 people)")

# Convert "Year" to numeric
df_melted["Year"] = pd.to_numeric(df_melted["Year"], errors="coerce")

# Sort by year
df_melted = df_melted.sort_values(by="Year")

# Display cleaned data
print(df_melted.head())
print(df_melted)

# Save the cleaned dataset (optional)


df_melted.to_csv("CSV CLEAN/Cleaned_API_IT.NET.BBND.P2.csv", index=True,  sep = ";")