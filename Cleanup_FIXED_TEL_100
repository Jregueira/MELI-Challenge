import pandas as pd

# Load the dataset (adjust the file path as needed)
file_path = "FIXED_TEL_100.csv"  # Change as needed for other files
df = pd.read_csv(file_path, skiprows=4)

# Filter only Argentina, Uruguay, and Chile
df_filtered = df[df["Country Name"].isin(["Argentina", "Uruguay", "Chile"])]

# Drop unnecessary columns
df_filtered = df_filtered.drop(columns=["Indicator Name", "Indicator Code", "Unnamed: 68"], errors="ignore")

# Reshape the dataframe to have years as a single column
df_melted = df_filtered.melt(id_vars=["Country Name", "Country Code"], 
                             var_name="Year", value_name="Value")

# Convert "Year" to numeric
df_melted["Year"] = pd.to_numeric(df_melted["Year"], errors="coerce")

# Sort by country and year
df_melted = df_melted.sort_values(by=["Country Name", "Year"])

# Display first few rows
print(df_melted.head())


df_melted.to_csv("CSV CLEAN/Clean_FIXED_TEL_100.csv", index=True,  sep = ";")